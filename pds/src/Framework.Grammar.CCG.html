<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="annot"><span class="hs-comment">{-|
Module      : Framework.Grammar.CCG
Description : CCG derivations.
Copyright   : (c) Julian Grove and Aaron Steven White, 2025
License     : MIT
Maintainer  : julian.grove@gmail.com

CCG types are defined and used to type strings, analogously to the way &#955;-terms
are typed.
-}</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Framework.Grammar.CCG</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Prel</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Framework.Lambda.html"><span class="hs-identifier">Framework.Lambda</span></a></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="Framework.Lambda.Types.html#Typed"><span class="hs-identifier">Typed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">-- * Expressions and grammatical categories</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">type</span><span> </span><span id="Word"><span class="annot"><a href="Framework.Grammar.CCG.html#Word"><span class="hs-identifier hs-var">Word</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="Expr"><span class="annot"><a href="Framework.Grammar.CCG.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Framework.Grammar.CCG.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="Cat"><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-var">Cat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Base"><span class="annot"><a href="Framework.Grammar.CCG.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-39"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span> </span><span id="%3A%2F%3A"><span class="annot"><a href="Framework.Grammar.CCG.html#%3A%2F%3A"><span class="hs-operator hs-var">:/:</span></a></span></span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span>
</span><span id="line-40"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span> </span><span id="%3A%5C%3A"><span class="annot"><a href="Framework.Grammar.CCG.html#%3A%5C%3A"><span class="hs-operator hs-var">:\:</span></a></span></span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077361"><span id="local-6989586621679077371"><span class="annot"><span class="annottext">Cat -&gt; Cat -&gt; Bool
(Cat -&gt; Cat -&gt; Bool) -&gt; (Cat -&gt; Cat -&gt; Bool) -&gt; Eq Cat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Cat -&gt; Cat -&gt; Bool
== :: Cat -&gt; Cat -&gt; Bool
$c/= :: Cat -&gt; Cat -&gt; Bool
/= :: Cat -&gt; Cat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077376"><span id="local-6989586621679077381"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679077388"><span class="annot"><span class="annottext">show :: Cat -&gt; String
</span><a href="#local-6989586621679077388"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Framework.Grammar.CCG.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679077390"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077390"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077390"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679077391"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077391"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#%3A%2F%3A"><span class="hs-operator hs-type">:/:</span></a></span><span> </span><span id="local-6989586621679077392"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077392"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Cat -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077391"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Cat -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077392"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679077393"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077393"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#%3A%5C%3A"><span class="hs-operator hs-type">:\:</span></a></span><span> </span><span id="local-6989586621679077394"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077394"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Cat -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077393"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Cat -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077394"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">infixl</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#%3A%2F%3A"><span class="hs-operator hs-type">:/:</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">infixl</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#%3A%5C%3A"><span class="hs-operator hs-type">:\:</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Framework.Grammar.CCG.html#%2F%2F"><span class="hs-operator hs-type">(//)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#%5C%5C"><span class="hs-operator hs-type">(\\)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Cat"><span class="hs-identifier hs-type">Cat</span></a></span><span>
</span><span id="line-53"></span><span id="local-6989586621679077397"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077397"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%2F%2F"><span class="annot"><span class="annottext">// :: Cat -&gt; Cat -&gt; Cat
</span><a href="Framework.Grammar.CCG.html#%2F%2F"><span class="hs-operator hs-var hs-var">//</span></a></span></span><span> </span><span id="local-6989586621679077398"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077398"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077397"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Cat -&gt; Cat -&gt; Cat
</span><a href="Framework.Grammar.CCG.html#%3A%2F%3A"><span class="hs-operator hs-var">:/:</span></a></span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077398"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-54"></span><span id="local-6989586621679077399"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077399"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%5C%5C"><span class="annot"><span class="annottext">\\ :: Cat -&gt; Cat -&gt; Cat
</span><a href="Framework.Grammar.CCG.html#%5C%5C"><span class="hs-operator hs-var hs-var">\\</span></a></span></span><span> </span><span id="local-6989586621679077400"><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077400"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077399"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Cat -&gt; Cat -&gt; Cat
</span><a href="Framework.Grammar.CCG.html#%3A%5C%3A"><span class="hs-operator hs-var">:\:</span></a></span><span> </span><span class="annot"><span class="annottext">Cat
</span><a href="#local-6989586621679077400"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="Lexicon"><span class="annot"><a href="Framework.Grammar.CCG.html#Lexicon"><span class="hs-identifier hs-var">Lexicon</span></a></span></span><span> </span><span id="local-6989586621679077402"><span class="annot"><a href="#local-6989586621679077402"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679077402"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="Project"><span class="annot"><a href="Framework.Grammar.CCG.html#Project"><span class="hs-identifier hs-var">Project</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Adjectives"><span class="annot"><a href="Framework.Grammar.CCG.html#Adjectives"><span class="hs-identifier hs-var">Adjectives</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Factivity"><span class="annot"><a href="Framework.Grammar.CCG.html#Factivity"><span class="hs-identifier hs-var">Factivity</span></a></span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">class</span><span> </span><span id="Interpretation"><span class="annot"><a href="Framework.Grammar.CCG.html#Interpretation"><span class="hs-identifier hs-var">Interpretation</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077407"><span class="annot"><a href="#local-6989586621679077407"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Framework.Grammar.CCG.html#Project"><span class="hs-identifier hs-type">Project</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679077408"><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span id="lexica"><span class="annot"><a href="Framework.Grammar.CCG.html#lexica"><span class="hs-identifier hs-type">lexica</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Framework.Grammar.CCG.html#Lexicon"><span class="hs-identifier hs-type">Lexicon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>  </span><span id="combineR"><span class="annot"><a href="Framework.Grammar.CCG.html#combineR"><span class="hs-identifier hs-type">combineR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>  </span><span id="combineL"><span class="annot"><a href="Framework.Grammar.CCG.html#combineL"><span class="hs-identifier hs-type">combineL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679077408"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-64"></span></pre></body></html>